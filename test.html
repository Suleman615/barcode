<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>QR Code Reader</title>


</head>

<body>
    <main>
        <div style="width: 400px; height: 400px;" id="reader"></div>
        <div id="result"></div>
    </main>

    <script src="/JS/index.js"></script>


    <script src="https://rawgit.com/mebjas/html5-qrcode/master/minified/html5-qrcode.min.js"></script>
    <script>
        function onScanSuccess(decodedText, decodedResult) {
            document.getElementById('result').innerHTML = `
            <p>${decodedText}</p>
            `;
            html5QrcodeScanner.clear();
        }

        function onScanFail(results) {
            console.log('No match found');
            document.getElementById('result').innerHTML = `
            <p>${results}</p>
            `;
        }

        async function setupCamera() {
            const devices = await navigator.mediaDevices.enumerateDevices();
            const videoDevices = devices.filter(device => device.kind === 'videoinput');
            const backCamera = videoDevices.find(device => device.label.toLowerCase().includes('back'));
            const cameraId = backCamera ? backCamera.deviceId : videoDevices[0].deviceId;

            let config = {
                fps: 10,
                qrbox: { width: 250, height: 250 },
                rememberLastUsedCamera: false,
                howTorchButtonIfSupported: true,
                supportedScanTypes: [Html5QrcodeScanType.SCAN_TYPE_CAMERA],
                deviceId: cameraId,
            };

            html5QrcodeScanner = new Html5QrcodeScanner("reader", config, false);
            html5QrcodeScanner.render(onScanSuccess, onScanFail);
        }

        setupCamera();
    </script>
</body>

</html>